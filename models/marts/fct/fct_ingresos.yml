version: 2

models:
  - name: fct_ingresos
    meta:
          joins:
            - join: dim_estr_organica
              sql_on: ${dim_estr_organica.centro_gestor} = ${fct_ingresos.organica_id}
            - join: dim_estr_economica
              sql_on: ${dim_estr_economica.subconcepto} = ${fct_ingresos.economica_id} and ${dim_estr_economica.gasto_ingreso} = 'I'
            - join: dim_estr_financiacion
              sql_on: ${dim_estr_financiacion.financiacion} = ${fct_ingresos.financiacion_id} and ${dim_estr_financiacion.gasto_ingreso} = 'I'
            - join : dim_tiempo
              sql_on: ${fct_ingresos.date_day} = ${dim_tiempo.fecha}
                      
          
    columns:
      - name: organica_id
      - name: economica_id
      - name: financiacion_id
      - name: date_day
      - name: importe
        meta:
            metrics:
              total_importe:
                type: sum
  